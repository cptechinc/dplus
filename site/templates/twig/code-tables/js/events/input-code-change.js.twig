// Display Alert if Code already exists
// NOTE: this if for single key codes

$("body").on("change", "input[name=code]", function(e) {
	var input = $(this);
	var code = input.val();

	server.validateCode(code, function(exists) {
		if (exists === true) {
			alert.codeExists(code, function(editCode) {
				var modal = input.closest('.modal');

				if (editCode) {
					server.getCode(code, function(response) {
						if (response) {
							modal.find('.modal-title').text('Edit Code');
							formCode.updateInputsFromJson(response);
							formCode.form.attr('data-serialized', formCode.form.serialize());
						} else {
							formCode.form.attr('data-serialized', '');
							formCode.updateInputsFromJson(response);
							formCode.inputs.code.focus();
						}
					});
				} else {
					var validator = formCode.form.validate();

					if (validator) {
						validator.resetForm();
					}
					formCode.form.attr('data-serialized', '');
					formCode.updateInputsFromJson();
					formCode.inputs.code.focus();
				}
			});
		}
	});
});