$(function() {
	var editmodal = $('#edit-item-modal');
	var editform  = $('#edit-item-form');

	editmodal.on('show.bs.modal', function (event) {
		var modal = $(this);
		var button = $(event.relatedTarget);
		var linenbr = intParse(button.data('linenbr'));

		modal.find('.modal-title').find('input[name=linenbr]').val(linenbr);
		modal.find('.modal-title').find('.linenbr').text(linenbr);
		modal.find('[role=status]').addClass('spinner-border');
		modal.find('.loading').addClass('show');
		var url = URI('{{ page.fullURL.getUrl() }}');
		url.path(url.path() + 'line/');
		url.setQuery('linenbr', linenbr);

		modal.find('.modal-body .results').loadin(url.toString(), function() {
			modal.find('[role=status]').removeClass('spinner-border');
			modal.find('.loading').removeClass('show');
		});
	});

	$('body').on('click', '#edit-item-modal .whse-link', function(e) {
		e.preventDefault();
		var button = $(this);
		var modal = $(button.closest('.modal'));
		modal.find('input[name=whseid]').val(button.data('whseid'));
	});

/* =============================================================
	Lookup Modal Functions
============================================================= */
	$("body").on('click', '#ajax-modal .whse-link', function(e) {
		e.preventDefault();
		var button = $(this);
		var modal = button.closest('.modal');
		var input = $(modal.attr('data-input'));
		input.val(button.data('whseid'));
		$('#ajax-modal').modal('hide');
	});
});
