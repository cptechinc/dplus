class CodeForm {
	static instance = null;

	static getInstance() {
		if (this.instance === null) {
			this.instance = new CodeForm();
		}
		return this.instance;
	}

	constructor() {
		this.id = 'code-form';
		this.form = $('#' + this.id);
		this.inputs = CodeInputs.getInstance();
		this.system = 'IN';
	}

	updateFormFromJson(json = null) {
		var modal = this.form.closest('.modal');
		modal.find('.modal-title').text('Editing ' + json.sysop);
		this.updateInputsFromJson(json);
	}

	updateInputsFromJson(json = null) {
		this.inputs.sysop.val('');
		this.inputs.code.val('');
		this.inputs.description.text('');

		var server   = CodeRequests.getInstance();
		var url = server.codeOptionsUrl(this.system, json.sysop);

		this.inputs.code.closest('.input-group').find('button[data-lookupurl]').attr('data-lookupurl', url);

		this.inputs.sysop.val(json.sysop);
		this.inputs.code.val(json.code);
		this.inputs.description.text(json.description);

		if (json.code) {
			this.inputs.submit.delete.removeAttr('disabled');
			server.getSysop(this.system, json.sysop, function(sysop) {

			});
		} else {
			this.inputs.submit.delete.attr('disabled', 'true');
		}
	}
}
