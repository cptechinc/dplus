<table class="table table-striped table-bordered table-condensed table-excel" id="invoices">
	<thead>
		{% for x in 1..blueprint['detail']['rowcount'] %}
			<tr>
				{% set columncount = 0 %}
				{% for i in 1..blueprint['cols'] + 1 %}
					{% set colspan = 0 %}
					{% if blueprint['detail']['rows'][x]['columns'][i] %}
						{% set column = blueprint['detail']['rows'][x]['columns'][i] %}
						{% set colspan = column['col-length'] %}
						<th colspan="{{ colspan }}" class="{{ module_formatter.get_justifyclass(properties['headingjustify']) }}">
							{{ column['label'] }}
						</th>
					{% else %}
						{% if columncount < blueprint['cols'] %}
							{% set colspan = 1 %}
							<th></th>
						{% endif %}
					{% endif %}
					{% set columncount = columncount + colspan %}
				{% endfor %}
			</tr>
		{% endfor %}
	</thead>
	<tbody>
		{% for id, invoice in json['data']['invoices'] %}
			{% if invoice != json['data']['invoices']['TOTAL'] %}
				{% for x in 1..blueprint['detail']['rowcount']  %}
					<tr>
						{% set columncount = 0 %}
						{% for i in 1..blueprint['cols'] + 1 %}
							{% set colspan = 0 %}
							{% if blueprint['detail']['rows'][x]['columns'][i] %}
								{% set column = blueprint['detail']['rows'][x]['columns'][i] %}
								{% set colspan = column['col-length'] %}
								<td colspan="{{ colspan }}" class="{{ module_formatter.get_justifyclass(column['data-justify']) }}">
									{{ module_formatter.format_celldata(invoice, column) }}

									{% if i == 1 and invoice['Invoice Number'] %}
										{% if document_management.count_arinvoicedocuments(invoice['Invoice Number']) %}
											<a href="{{ page.documentsview_arinvoice(custID, invoice['Invoice Number'])}}" class="text-success" title="View Documents for Quote # {{ invoice['Invoice Number'] }}">
												<i class="fa fa-file-text" aria-hidden="true"></i> <span class="sr-only">View Documents for Invoice # {{ invoice['Invoice Number'] }}</span>
											</a>
										{% endif %}
									{% endif %}
								</td>
							{% else %}
								{% if columncount < blueprint['cols'] %}
									{% set colspan = 1 %}
									<td></td>
								{% endif %}
							{% endif %}
							{% set columncount = columncount + colspan %}
						{% endfor %}
					</tr>
				{% endfor %}
			{% endif %}
		{% endfor %}
	</tbody>
	<tfoot>
		{% set invoice = json['data']['invoices']['TOTAL'] %}
		{% set x = 1 %}
		<tr class="bg-danger font-weight-bold">
			{% set columncount = 0 %}
			{% for i in 1..blueprint['cols'] + 1 %}
				{% set colspan = 0 %}
				{% if blueprint['detail']['rows'][x]['columns'][i] %}
					{% set column = blueprint['detail']['rows'][x]['columns'][i] %}
					{% set colspan = column['col-length'] %}
					<td colspan="{{ colspan }}" class="{{ module_formatter.get_justifyclass(column['data-justify']) }}">
						{{ module_formatter.format_celldata(invoice, column) }}
					</td>
				{% else %}
					{% if columncount < blueprint['cols'] %}
						{% set colspan = 1 %}
						<td></td>
					{% endif %}
				{% endif %}
				{% set columncount = columncount + colspan %}
			{% endfor %}
		</tr>
	</tfoot>
</table>
