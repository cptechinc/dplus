<?php namespace ProcessWire;

use Purl\Url;

/**
 * class DpagesMpo
 *
 * Installs fields, templates, pages, hooks necessary for Mpo Pages
 * Adds Hooks for getting URLs to Mpo pages
 */
class DpagesMpo extends Dpages implements Module {
	const FIELDS = array();

	const TEMPLATES = array(
		'purchase-orders' => array(
			'name'   => 'purchase-orders',
			'fields' => array(),
			'paginated' => true
		),
		'purchase-orders-vendor' => array(
			'name'   => 'purchase-orders-vendor',
			'fields' => array(),
			'paginated' => true
		),
		'purchase-history-orders' => array(
			'name'   => 'purchase-orders-history',
			'fields' => array(),
			'paginated' => true
		),
		'purchase-history-orders-vendor' => array(
			'name'   => 'purchase-orders-history-vendor',
			'fields' => array(),
			'paginated' => true
		),
	);

	const PAGES = array(
		'po-menu' => array(
			'template'       => 'dplus-menu',
			'name'           => 'mpo',
			'title'          => 'Purchase Orders',
			'summary'        => 'Purchase Orders Menu',
			'parent'         => '/',
			'dplus_function' => '' // TODO: Change to mpo
		),
		'po-list' => array(
			'template'       => 'dplus-function',
			'name'           => 'purchase-orders',
			'title'          => 'Purchase Orders',
			'summary'        => 'View Purchase Orders',
			'parent'         => '/mpo/',
			'dplus_function' => '',
			'pw_template'    => 'purchase-orders'
		),
		'po-list-vendor' => array(
			'template'       => 'dplus-function',
			'name'           => 'vendor',
			'title'          => 'Vendor Purchase Orders',
			'summary'        => 'View Vendor Purchase Orders',
			'parent'         => '/mpo/purchase-orders/',
			'dplus_function' => '',
			'pw_template'    => 'purchase-orders-vendor'
		),
		'po-view' => array(
			'template'       => 'dplus-function',
			'name'           => 'purchase-order',
			'title'          => 'Purchase Order',
			'summary'        => 'View Purchase Order',
			'parent'         => '/mpo/',
			'dplus_function' => '',
			'pw_template'    => 'purchase-order-view'
		),
		'purchase-history-list' => array(
			'template'       => 'dplus-function',
			'name'           => 'purchase-history',
			'title'          => 'Purchase History',
			'summary'        => 'View Purchase Order History',
			'parent'         => '/mpo/',
			'dplus_function' => '',
			'pw_template'    => 'purchase-history-orders'
		),
	);

	/**
	 * Returns URL to Purchase Orders Page
	 * @return string           URL
	 */
	public function get_purchaseordersURL() {
		return $this->wire('pages')->get('pw_template=purchase-orders')->url;
	}

	/**
	 * Returns URL to Purchase Orders Vendor Page
	 * @return string           URL
	 */
	public function get_purchaseorders_vendorURL() {
		return $this->wire('pages')->get('pw_template=purchase-orders-vendor')->url;
	}

	/**
	 * Returns URL to Purchase Orders Page
	 * @return string           URL
	 */
	public function get_purchasehistoryURL() {
		return $this->wire('pages')->get('pw_template=purchase-history-orders')->url;
	}

	/**
	 * Returns URL to Purchase Orders Vendor Page
	 * @return string           URL
	 */
	public function get_purchasehistory_vendorURL() {
		return $this->wire('pages')->get('pw_template=purchase-history-orders-vendor')->url;
	}

	public static function getModuleInfo() {
		return array(
			'title' => 'Dplus Online Purchase Order Pages',
			'version' => 101,
			'summary' => 'Installs and creates Dplus Online Purchase Order Pages',
			'singular' => true,
			'autoload' => true,
		);
	}
}
